# The Reichenbach reckoning

1. [Written problems](#1-written-problems)
	1. [The seating of the Diogenes Club](#11-the-seating-of-the-diogenes-club)  
	2. [The cipher arrays of Irene Adler](#12-the-cipher-arrays-of-irene-adler)  
	3. [The paths of the hound](#13-the-paths-of-the-hound)  
	4. [The poker game at Reichenbach](#14-the-poker-game-at-reichenbach)  
	5. [The binary telegram of Baskerville](#15-the-binary-telegram-of-baskerville)  
	6. [The menagerie of Moriarty](#16-the-menagerie-of-moriarty)  
	7. [The investments of Baker Street](#17-the-investments-of-baker-street)  
	8. [The coding conundrum of Scotland Yard](#18-the-coding-conundrum-of-scotland-yard)  
	9. [The passwords of the naval treaty](#19-the-passwords-of-the-naval-treaty)  
	10. [The dice of the Speckled band](#110-the-dice-of-the-speckled-band)  
	11. [The letters of the Red-Headed League](#111-the-letters-of-the-red-headed-league)
	12. [The buckets of Bohemia](#112-the-buckets-of-bohemia)
2. [Coding problems](#2-coding-problems)
	1. [The game of the final problem](#21-the-game-of-the-final-problem)

> [!IMPORTANT]
> **Disclaimer: AI tools assistance**
> The following exercises are the result of a student who really wants to learn, and these are not copy-pasted solutions generated by some AI chatbot. AI assistance has been kept to an absolute bare minimum -namely, just to verify/compare solutions-.

> [!WARNING]
> **Warning: unreviewed document**
>  The following exercises have not been reviewed by expert humans; be aware their solutions can contain mistakes.

## 1. Written problems

### 1.1. The seating of the Diogenes Club
Sherlock Holmes investigates a clandestine meeting at the Diogenes Club, where 10 distinct members must sit in a row under strict protocols:
1. If no rules bind their arrangement, how many ways can the silent gentlemen be seated?
2. Suppose Mycroft Holmes and his aide, bound by mutual distrust, must sit side-by-side to monitor each other—how many arrangements are possible?
3. If 5 are seasoned inspectors and 5 are novice constables, and no two of the same rank may sit adjacent (lest rivalries flare), how many seating orders hold?
4. If the 10 form 5 pairs of informants and handlers, each pair inseparable due to whispered secrets, how many arrangements emerge?

_Deduction_: explain your reasoning as if briefing Watson on the club’s hidden hierarchy.

1. **Answer**: $10!$
   A simple permutation of the 10 gentlemen explains the results.
2. **Answer**: $9! \cdot 2$
   Mycroft and his aide must seat side-by-side, hence they move like if they were a single person; within the couple, the number of possible permutations is just $2! = 2$. Permuting the positions of $8+1=9$ people (where the $+1$ is the couple described before) we get $9!$ orderings. Doing the cartesian product between the former and the latter permutations, we get the result, $9! \cdot 2$. Another way to see the problem is this: the internal permutations of a couple is $2!=2$, the permutations of such side-by-side couple within 10 positions are $10-1=9$, the remaining permutations are $8!$, since $8$ is the number of remaining gentlemen. Putting all together: $9 \cdot 8! \cdot 2 = 9! \cdot 2$.
3. **Answer**: $(5!)^2 \cdot 2$
   Since neither two inspectors nor two constables can seat in an adjacent position, the only orderings admitted are those where there is an interleaving. Hence, we have 2 possible situations: the first one is an ordering where inspectors occupy even positions (positions 2, 4, 6, 8, 10) and constables odd ones (1, 3, 5, 7, 9), and a second one which is the exact converse of the first. Within those positions, we have two permuting groups of 5 elements each. The result is then straightforward: $5! \cdot 5! \cdot 2 = (5!)^2 \cdot 2$.
4. **Answer**: $(5!)^2$
   We want to form pairs out of 10 gentlemen, divided into two groups of 5 people each: 5 informants, and 5 handlers. The first (random) informant can be associated with 5 possible handlers, the second one with 4, and so on: given a fixed order of the informants, we get $5!$ possible pairings. Since the possible orderings of informants is $5!$ (essentially, all their permutations), the final answer is $(5!)^2$.

### 1.2. The cipher arrays of Irene Adler
Irene Adler hides messages in sorted arrays of $k$ distinct integers, each from $1$ to $n$ (e.g. $1 \leq x[0] \lt x[1] \lt \ldots \lt x[k-1] \leq n$). How may such arrays can she devise, as if concealing clues in a locked box?

_Deduction_: unravel the pattern as if outwitting her guile.

1. **Answer**: $n \choose k$
   This apparently looks like as a permutation problem, but the sorting requirement imposes us to think differently. Let's consider this example: if $n=5$ and $k=3$, we can reason on the sequence $\{1,2,3,4,5\}$. Now, if we consider the ordered subsets of the numbers $1,2,3$ we have $\{1,2,3\}$, $\{1,3,2\}$, $\{2,1,3\}$, $\{2,3,1\}$, $\{3,2,1\}$ and $\{3,1,2\}$; of these subsets, just the first one is sorted. This reasoning can be extended to an arbitrary selection of $k$ integers, meaning that we have to count just one valid subset over all the possible permutations of the same set of integers. This is equivalent to count the number of possible subsets _without_ considering the placement of their object, which is just a plain combination. The answer is then straightforward: we have just ${n \choose k}$ valid arrays. 

### 1.3. The paths of the hound
A mechanical hound roams an $n \times m$ grid from $(1,1)$ to $(n,m)$, moving only right or down:
1. With no bounds, how many trails can it leave?
2. If it must first lurch right (a faulty gear), how many paths remain?
3. If it switches direction exactly thrice (right-to-down or down-to-right), how many routes obey?

_Deduction_: track its steps as if hunting it across the moors.

1. **Answer**: ${n+m-2 \choose n-1}$
   The mechanical hound has only two options: move right, or move down; in particular, we can find that, no matter the path taken, it has to move $(n-1)$ times down, and $(m-1)$ times right, and this accounts to $(n-1)+(m-1)+2=n+m$ total positions (including the starting and the final states, too)\*. If we respectively represent those actions with the letters $R$ and $D$, we can model each trail as a unique sequence of actions; for example, the sequence $(R, R, D, ..., D)$ encodes a path where the hound goes right two times, then goes down, and so on and so forth. 
   Now, we can choose $n+m-2 \choose n-1$ _down_ actions placements (since $R_1,R_2,...)=(R_2,R_1, ...)=(R,R,...)$. After fixing the down actions, the remaining positions can just be _right_ actions, hence ${n+m-2 \choose n-1}={n+m-2 \choose m-1}$ is the final answer.
   \*: the proof of this statement can be found by induction.
2. **Answer**: $n+m-3 \choose n-1$
   If the first action is fixed, we are left with $n+m-3$ actions to reach the target. Following the same reasoning of the first mystery, the answer is $n+m-3 \choose n-1$.
3. **Answer**: $2{n+m-5 \choose n - 3}$ (at the beginning only) or $(n+m-4) \cdot {n+m-2 \choose n-3}$ (arbitrary pos.)
   If the triple action switch constraint is applied at the beginning of the path traversal, the answer is obtainable using again the same strategy of the previous mysteries. There are $n+m-5$ free actions for each trail, hence $2{n+m-5 \choose n - 3}$ since the erratic initial sequences are  $(R,D,R)$ and $(D,R,D)$).
   If the constraint can be activated at any point of the grid traversal (assuming that every possible action sequence must contains a _whole_ thrice switch subsequence), we have to adjust the result multiplying by the number of positions from which the constraint itself can be triggered. Since there are $n+m-2$ actions, we can initiate the ill subsequence in any of $n+m-4$ action points; the adjusted result is then $(n+m-4) \cdot {n+m-2 \choose n-3}$.

### 1.4. The poker game at Reichenbach
Holmes faces Moriarty at a poker table, where all $5$-card hands from a $52$-card deck are equally likely:
1. What’s the chance of a flush (all same suit), including straight flushes?
2. What’s the chance of two pairs (a, a, b, b, c, distinct values)?
3. What’s the chance of four of a kind (a, a, a, a, b, distinct)?

_Deduction_: compute the odds as if spotting Moriarty’s bluff.

1. **Answer**: $\mathbb{P}(E) = \frac{|E|}{|S|}$, where $|S| = {52 \choose 5}$ and $|E| = 4{13 \choose 5}$
   The sample space of 5 randomly drawn cards is $|S|={52 \choose 5}$. The event space of all kind of flushes is given by how many ways we can draw 5 cards out of 13, which is the number of cards having the same seed/suit. This means we have $13 \choose 5$ valid draws. Since the suits are 4, we can calculate $|E| = 4 {13 \choose 5}$.
2. **Answer**: $\mathbb{P}(E)=\frac{|E|}{|S|}$, where $={4 \choose 2}{13 \choose 2}{11 \choose 1}{4 \choose 1}$, and $|S|= {52 \choose 5}$ 
   In this exercise is convenient to split up the reasoning according to suits and value. In order to get two pairs with distinct values, the idea is this: there are 4 suits, and we have to choose 2 of them: this gives $4 \choose 2$ selections; there are 13 values, and we have to choose 2: this gives $13 \choose 2$ selections (in this way we are automatically excluding pokers, i.e. two pairs all having the same value). The first 4 valid cards can be thus selected in ${4 \choose 2}{13 \choose 2}$ ways; the last card can be selected from the remaining ones, which are ${13 - 2 \choose 1}{4 \choose 1}$. The multiplication of these intermediate result is exactly the event space $|E|={4 \choose 2}{13 \choose 2}{13 - 2 \choose 1}{4 \choose 1}={11 \choose 1} \cdot 4$, while the sample space size is the same as that of the previous exercise, i.e. $|S|={52 \choose 5}$.
3. **Answer**: $\mathbb{P}(E)=\frac{|E|}{|S|}$, where $|E| = {13 \choose 1}{4 \choose 1}{12 \choose 1}{4 \choose 1}$, $|S|={52 \choose 5}$
   Following the line of the previous exercise, a poker can be done just fixing all card values to be the same, and all suits to be different. This means that the event space is $|E|={13 \choose 1}{4 \choose 1}{12 \choose 1}{4 \choose 1}$: the first two binomial coefficient calculate the number of pokers (i.e. four cards of the same value), while the latter two calculate the number of all possible fifth cards. The sample space size is always the same of the previous exercises.

### 1.5. The binary telegram of Baskerville
1. A telegraph sends $m$ $0$'s and $n$ $1$’s in random order. What’s the chance the first $r$ bits hold exactly $k$ $1$’s, as if decoding a hound’s howl?

_Deduction_: reason through the static as if time is running out.

1. **Answer**: $\mathbb{P}(E) = \frac{|E|}{|S|}$, where $|E|={n \choose k}{m \choose r-k}$ and $|S| = {n+m \choose r}$
   As a first thing, we can derive that $r \leq n+m$, modelling the fact that the first $r$ bits are at most the total number of transmitted bits; we also assume $k \leq r$, which means that the number of $1$'s cannot found in the first $r$ bits cannot exceed $r$ in any case. The cardinality of the sample space $S$ can be find like this: after fixing the numbers $n$, $m$ of ones and zeros, we can find $m$ zeros in any position of the $n+m$ sequence; the same applies to the $n$ ones. Hence, the first $r$ bits can be any of the possible subsets of length $r$ out of the whole $n+m$ sequence. This immediately gives us the answer:  $|S| = {n+m \choose r}$. The event space is a little bit more tricky. If we want _exactly_ $k$ ones, we have to select $k$ of them from the total of $n$, which is $n \choose k$; of course, this means that the zeros must be selected between the total of $m$, and we should pick $r-k$ of them (basically the remaining space after filling with $k$ ones). This can be counted as $m \choose r-k$. Multiplying those quantities we get the number of valid sequences, which is also the size of the event space: $|E|={n \choose k}{m \choose r-k}$. The requested probability is then $\frac{|E|}{|S|}$.

### 1.6. The menagerie of Moriarty
Holmes uncovers Professor Moriarty’s scheme to display 3 bird species and 3 reptile species, selected from 8 birds and 6 reptiles, in a sinister zoo:
1. If Moriarty chooses freely, how many exhibits can he craft?
2. Two birds—one a hawk with a piercing cry, the other a raven with a deadly glare—cannot coexist without chaos. How many exhibits avoid this peril?
3. A venomous parrot and a cobra, when paired, unleash a toxic fog. How many exhibits dodge this trap?

_Deduction_: justify your counts as if tracing Moriarty’s twisted logic.

1. **Answer**: ${8 \choose 3}{6 \choose 3}$
   Assuming distinctiveness of all bird and reptile species, we can choose 3 birds species out of 8 available (i.e. ${8 \choose 3}$ combinations), and 3 reptile species out 6 (i.e. ${6 \choose 3}$ combinations). The total number of combinations is thus equal to ${8 \choose 3}{6 \choose 3}$, which is just the cartesian product of the individual selection sets.
2. **Answer**: ${8 \choose 3}{6 \choose 3} - {6 \choose 1}{6 \choose 3}$
   Since we do not want the hawk and the raven to coexist in the exhibition, we must choose every time from a set of $7$ birds instead of $8$. This means that once we have fixed which bird we should include in the selection (hawk _xor_ raven), we get ${7 \choose 3}$ possible selections; multiplying this number by $2$ also account for the mutual exclusive choice. The number of choices of reptiles remains the same of exercise 1, hence the final answer is: $2{7 \choose 3}{6 \choose 3}$.
   In this exercise is more convenient to calculate invalid selections, and eliminate them from the total calculated in the first exercise. The selection of birds including both the hawk and the raven are $6 \choose 1$ (basically, only the third bird can be freely choose from the $8-2=6$ remaining ones). Multiplying this number by the arrangement of reptiles, which is $6 \choose 3$ since no conditions are applied here, we obtain the final answer: ${8 \choose 3}{6 \choose 3} - {6 \choose 1}{6 \choose 3}$.
3. **Answer**: ${8 \choose 3}{6 \choose 3} - {7 \choose 2}{5 \choose 2}$
   This is exactly equal to the number of possible combinations without restrictions (i.e. ${8 \choose 3}{6 \choose 3}$) minus by the number of combinations having both conflicting animals included: ${7 \choose 2}{5 \choose 2}$.

### 1.7. The investments of Baker Street
Holmes secures £20 million to fund 4 shadowy enterprises, investing in £1 million units, each with a minimum stake: £1M, £2M, £3M, £4M.
1. If all 4 must be funded to foil Moriarty’s network, how many strategies exist?
2. If at least 3 must be backed (to keep the web intact), how many plans work?

_Deduction_: argue your totals as if pitching to a wary Watson.

1. **Answer**: $4!{13 \choose 3}$
   We have $4$ companies, each with $4$ possible minimum stakes: £1M, £2M, £3M, £4M. This means that exactly £10M must already be allocated, while the remaining £10M can be distributed somewhat freely. This is a bucketing problem, where we have to put those remaining £10M into 4 buckets (i.e. companies). This is now easily computable: ${10+4-1 \choose 4-1}={13 \choose 3}$. Multiplying this number with the possible allocations of the fixed £10M, we have the final result: $4!{13 \choose 3}$. The $4!$ factor accounts for the different allocation of the fixed initial sums, which is a simple permutation of the number of companies/sums.
2. **Answer**: $3! \sum\limits_{i=0}^{3}{13+i \choose 2} + 4!{13 \choose 3}$
   In the case where at least 3 companies must be backed, we have a more complex allocation variability that has to be taken into account. The mandatory investment portion can be allocated in $3!$ or $4!$ ways, since there are $3!$ ways to choose a subset of 3 from the set of 4 initial stake investments {£1M, £2M, £3M, £4M}, and just four ways to choose 4 out of 4 (i.e. $4!$). For each different initial stake sum, we have a different bucketing problems:
   - {£1M, £2M, £3M} = £6M $\rightarrow$ £14M free: the number of free strategies is ${14+3-1 \choose 3-1} = {16 \choose 2}$; one company will not be backed.
   - {£1M, £2M, £4M} = £7M $\rightarrow$ £13M free: the number of free strategies is ${13+3-1 \choose 3-1} = {15 \choose 2}$; one company will not be backed.
   - {£1M, £3M, £4M} = £8M $\rightarrow$ £12M free: the number of free strategies is ${12+3-1 \choose 3-1} = {14 \choose 2}$; one company will not be backed.
   - {£2M, £3M, £4M} = £9M $\rightarrow$ £11M free: the number of free strategies is ${11+3-1 \choose 3-1} = {13 \choose 2}$; one company will not be backed.
   - {£1M, £2M, £3M, £4M} = £10M $\rightarrow$ £10M free: the number of free strategies are ${13 \choose 3}$, as in exercise 1.
   The final answer is then: $3! \sum\limits_{i=0}^{3}{13+i \choose 2} + 4!{13 \choose 3}$.

### 1.8. The coding conundrum of Scotland Yard
Holmes probes a cryptography school where 100 agents study 3 courses—Java, C++, Python—under Lestrade’s watch:
- Java: 27 agents; C++: 28; Python: 20
- 12 crack Java and C++; 5 master Java and Python; 8 excel in C++ and Python
- 2 prodigies conquer all three

1. What’s the chance a random agent has evaded all courses, lurking in the shadows?
2. What’s the chance an agent studies exactly one, avoiding the others’ scrutiny?
3. If two agents are nabbed, what’s the odds at least one knows a course? Give a final number.

_Deduction_: map the overlaps as if decoding a Yard cipher—explain each step.

1. **Answer**: $\frac{48}{100}$
   In order to compute the request probability, we have to count how many agents have actually followed at least one course; summing the agents that followed the Java, C++ and Python courses, i.e. $27+28+20=75$, will lead us to count multiples times some of the same agents, hence we have to compute how many agents took one, two and three courses respectively. Two prodigy agents follow all 3 courses; this means that there are $12 - 2 = 10$ person that where in both the Java/C++ courses, $5 - 2 = 3$ that where in both the Java/Python courses, and $8 - 2 = 6$ in both the C++/Python courses. Summing up the agents taking two courses, we get a total of $10+3+6=19$ agents. To understand how many agents just took one course, it is sufficient to avoid double counting agents that took two or three courses: we can thus calculate that $27 - (10+2+3)=12$ agents followed just the Java course, $28-(10+2+6)=10$ agents followed just the C++ course, and $20-(3+6+2)=9$ agents followed just the Python course. Summing up, we have 31 agents that followed just one course, and $31+19+2=52$ agents that followed at least one course. The answer is then $\frac{100-52}{100}=\frac{48}{100}$.
2. **Answer**: $\frac{31}{100}$
   We already solved this exercise as a subroutine of the first one. The answer is $\frac{31}{100}$.
3. **Answer**: $1 - \frac{48}{100} \cdot \frac{47}{99}$
   Using the answer of the previous exercises, we can create two groups: one group containing agents that followed no course (25 agents), and another having followed at least one course (75 agents). The sample space is the set of all possible pairs, i.e. $\binom{100}{2}$, while the event space is given by the sample space minus the set of all pairs of agents having followed any course. This number is $\binom{25}{2}$, hence the asked probability is $\frac{|E|}{|S|}$, where $|E| = \binom{25}{2}$ and $|S| = \binom{100}{2}$.
   In this exercise is advantages to calculate the probability that two agents followed no course, and then subtract it from the total. The probability that an agent follows no course has been calculated in the first exercise, and is equal to $\frac{48}{100}$. Assuming we select the first agent that has followed no course, for the second iteration the same probability must be adjusted by the fact that such agent is not available anymore for selection. This means that the probability of selecting two agents who has followed no course is exactly $\frac{48}{100} \cdot \frac{47}{99}$, and the final answer can be straightforwardly calculated as $1 - \frac{48}{100} \cdot \frac{47}{99}$.

### 1.9. The passwords of the naval treaty
A spy tackles $n$ distinct passwords, one unlocking a treaty:
1. Trying randomly and discarding failures, what’s the chance the $k$-th attempt succeeds?
2. Trying randomly without discarding, stopping at success, what’s the chance the $k$-th try wins?

_Deduction_: think like the spy—explain as if Holmes is one step ahead.

1. **Answer**: $\frac{1}{n-k+1} \prod_{i=1}^{k-1} \frac{n-i}{n-i+1}$
   In order to get the $k$-th attempt a success, the first $k-1$ must be failures. This means that we have a chain of failure probabilities: $\frac{n-1}{n} \cdot \frac{n-2}{n-1} \cdots \frac{n-k+1}{n-k+2} = \prod_{i=1}^{k-1} \frac{n-i}{n-i+1}$. At this we have to multiply the probability that at the $k$-th attempt we get the right password; if we have tried $k-1$ out of a total of $n$ passwords, the remaining passwords are $n-k+1$. The chance to find the correct password at the $k$-th attempt is then $\frac{1}{n-k+1}$, which, multiplied by the term calculated above, gives us the final answer: $\frac{1}{n-k+1} \prod_{i=1}^{k-1} \frac{n-i}{n-i+1}$.
2. **Answer**: $\frac{1}{n}(1-\frac{1}{n})^{k-1}$
   This exercise can be resolved in a way similar to the first one, with the only difference that we "loose" memory of which password we tried. Assuming that we want to win at the $k$ attempt (since this is our wanted result), for the first $k-1$ attempts we have to lose. The probability to lose $k-1$ times with no memory is $(1-\frac{1}{n})^{k-1}$; the probability to win at the $k$-th attempt is just $\frac{1}{n}$. Gathering all together, the probability to lose $k-1$ times and then win at the $k$-th iteration is $\frac{1}{n}(1-\frac{1}{n})^{k-1}$.

### 1.10. The dice of the Speckled band

Holmes rolls a six-sided die six times to crack a gypsy code:
1. What’s the chance two numbers appear thrice each (e.g., three 4s, three 6s)?
2. What’s the chance exactly one number hits thrice, no more, no less?

_Deduction_: interpret the rolls as if they spell a fatal clue—mind the overlaps.

1. **Answer**: $\mathbb{P}(E) = \frac{|E|}{|S|} =\frac{{6 \choose 2}{6 \choose 3}}{6^6}$
   All the six tosses of the die are independent. The sample space is given by all the possible outcomes of six tosses: this means $|S| = 6^6$, since for each of the six launches we have six possible outcomes. After having chosen a fixed number, we have $6 \choose 3$ possible positions for a tuple of three occurrences of that number. Given that we have to choose a pair of distinct numbers of which we want triplets (e.g. 4 and 6, 1 and 2, ...), the number of possible choices is $6 \choose 2$. The size of the even space is thus $|E| = {6 \choose 2}{6 \choose 3}$. The answer is then $\frac{|E|}{|S|} =  \frac{{6 \choose 2}{6 \choose 3}}{6^6}$.
2. **Answer**: $\mathbb{P}(E) = \frac{|E|}{|S|} = \frac{{6 \choose 1}{6 \choose 3}(5^3-5)}{6^6}$
   Choose one number out of six: $6 \choose 1$; choose three arbitrary outcomes out of 6 launches results: $6 \choose 3$; the other outcomes must not be the same number, and launches are independent: $5^3-5$. Putting all together: $|E|={6 \choose 1}{6 \choose 3}(5^3-5)$. The sample space size is always $|S|=6^6$.
   

### 1.11. The letters of the Red-Headed league
Holmes dispatches 20 distinct letters to 12 unique informants, each landing randomly. What’s the chance 4 get exactly 2 letters and 3 get exactly 4, the rest empty-handed?

_Deduction_: trace the mail as if thwarting a league plot.

1. **Answer**:  $\frac{|E|}{|S|}$, where $|E|={12 \choose 4}\frac{20!}{12!2^4}{8 \choose 3}\frac{12!}{(4!)^3}$ and $|S|=12^{20}$
   Selecting 4 informants out of 12 is $12 \choose 4$; the possible selection of 8 letters out of 20 are ${20 \choose 8}8!=\frac{20!}{12!}$. Given an informant, the letter order he/she received is not important, since $\{letter_A,letter_B\}=\{letter_B,letter_A\}$; this means that we have to divide by 2 the number of possible letter selection, and do this four times: i.e. $(2^4)^{-1}$. We obtain a total number of valid assignments equal to ${12 \choose 4}\frac{20!}{12!2^4}$. The same exact reason has to be done for the three informants getting 4 letters each, adjusting the numbers according to the fact that we already partially assigned letters to informants in the first part of the exercise. The ways to assign 4 letters to 3 informant is thus ${8 \choose 3}\frac{12!}{(4!)^3}$. Since the sample space size is $12^{20}$, the answer is given by $\frac{|E|}{|S|}$, where $|E|={12 \choose 4}\frac{20!}{12!2^4}{8 \choose 3}\frac{12!}{(4!)^3}$.
   

### 1.12. The buckets of Bohemia
$M$ clues are hashed into $n$ buckets by a rogue algorithm, all $N^M$ outcomes equal. What’s the chance exactly $k$ land in the first bucket?

_Deduction_: model the scatter as if piecing together a broken photograph.

1. **Answer**: ${M \choose k}(\frac{1}{n})^k(1-\frac{1}{n})^{M-k}$; also $Bin(p=\frac{1}{n},M)$
   First, we need the compute the number of possible subsets of $k$ elements out of $M$ clues; this is simply equal to $M \choose k$. The probability that a clue is dropped in the first bucket is equal to the probability that the same clue enters in any of the buckets, since all the outcomes are equal by assumption. This means that after $k$ iterations, such probability is exactly $(\frac{1}{n})^k$, while the probability that the rest of the $M-k$ clues are put in the remaining buckets is exactly $(1- \frac{1}{n})^{M-k}$ (we want the first bucket to be filled with _exactly_ $k$ clues, hence we must impose the condition that _exactly_ $M-k$ _do not_ belong to the first bucket). At this point, calculating the probability is just a matter of multiplying those intermediate results: the answer is ${M \choose k}(\frac{1}{n})^k(1-\frac{1}{n})^{M-k}$. This exercise could be easily solved using a binomial distribution parametrization, since the answer is just $Bin(p=\frac{1}{n},M)$.


## 2. Coding problems

### 2.1. The game of the final problem
Holmes and Moriarty duel with a device spitting integers from 1 to 100. Holmes adds to S (from 0) until $S$ > 100, noting his last number $x$. Moriarty resumes, adding until $S$ > 200, noting $y$. The higher wins. Simulate 100,000 rounds in Python3 and estimate Moriarty’s victory odds, as if outsmarting Holmes at Reichenbach.

_Deduction_: code as if the fate of London hangs in the balance—comment your logic.

1. **Answer**: Moriarty victory odds are around 52%.
The code used to simulate the game is the following:
```python
import random
import sys

def simulate_game(rounds=100_000):
	holmes_victories = moriarty_victories = draws = 0
	for _ in range(rounds):
		# Reinitializing all transient vars at each experiment round
		sum = holmes_last_draw = moriarty_last_draw = 0
		# Holmes' turn: he must play untils sum > 100
		while sum <= 100:
			holmes_last_draw = random.randint(1,100)
			sum += holmes_last_draw
		# Moriarty's turn: he must play until sum > 200
		while sum <= 200:
			moriarty_last_draw = random.randint(1,100)
			sum += moriarty_last_draw
		if holmes_last_draw > moriarty_last_draw:
			holmes_victories += 1
		elif holmes_last_draw < moriarty_last_draw:
			moriarty_victories += 1
		else:
			draws += 1
	return holmes_victories/rounds, moriarty_victories/rounds, draws/rounds

if __name__ == "__main__":
	rounds = int(sys.argv[1]) if len(sys.argv) > 1 else 100_000
	holmes_victory_ratio, moriarty_victory_ratio, draws_ratio = simulate_game(rounds)
	print(f"Holmes victory rate: {100 * holmes_victory_ratio:.2f}%")
	print(f"Moriarty victory rate: {100 * moriarty_victory_ratio:.2f}%")
	print(f"Draws rate: {100 * draws_ratio:.2f}%")
```
The results are synthetized in the following table, which also shows the answer to the exercise:

| Rates                    | Stats  |
| ------------------------ | ------ |
| **Holmes victory rate**  | 46.54% |
| **Moriary victory rate** | 52.24% |
| **Draws rate**           | 1.22%  |

